<div style="max-width:420px;margin:60px auto;">
  <h2>Create account</h2>

  <form (ngSubmit)="submit()" [formGroup]="form" novalidate>
    <mat-form-field appearance="outline" style="width:100%;">
      <mat-label>Username</mat-label>
      <input matInput formControlName="username" autocomplete="username" />
      <mat-error *ngIf="hasError('username','required')">Mandatory field</mat-error>
      <mat-error *ngIf="hasError('username','minlength')">3 characters minimum</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" style="width:100%;">
      <mat-label>Email</mat-label>
      <input matInput type="email" formControlName="email" autocomplete="email" />
      <mat-error *ngIf="hasError('email','required')">Mandatory field</mat-error>
      <mat-error *ngIf="hasError('email','email')">Invalid email</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" style="width:100%;">
      <mat-label>Password</mat-label>
      <input matInput [type]="hide ? 'password' : 'text'" formControlName="password" autocomplete="new-password" />
      <button mat-icon-button matSuffix type="button" (click)="hide = !hide" [attr.aria-label]="'toggle password'">
        <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="hasError('password','required')">Mandatory field</mat-error>
      <mat-error *ngIf="hasError('password','minlength')">6 characters minimum</mat-error>
    </mat-form-field>

    <mat-form-field appearance="outline" style="width:100%;">
      <mat-label>Repeat your password</mat-label>
      <input matInput [type]="hideConfirm ? 'password' : 'text'" formControlName="confirm" autocomplete="new-password" />
      <button mat-icon-button matSuffix type="button" (click)="hideConfirm = !hideConfirm" [attr.aria-label]="'toggle confirm'">
        <mat-icon>{{ hideConfirm ? 'visibility_off' : 'visibility' }}</mat-icon>
      </button>
      <mat-error *ngIf="hasError('confirm','required')">Mandatory field</mat-error>
      <mat-error *ngIf="form.hasError('passwordsMismatch') && form.get('confirm')?.touched">
        Passwords are not the same
      </mat-error>
    </mat-form-field>

    <div *ngIf="error" style="color:#c62828;margin:8px 0;">{{ error }}</div>

    <button mat-raised-button color="primary" type="submit" [disabled]="loading || form.invalid" style="width:100%;">
      {{ loading ? 'Creating...' : 'Create account' }}
    </button>

    <div style="text-align:center;margin-top:12px;">
      <a routerLink="/">Return to login</a>
    </div>
  </form>
</div>

